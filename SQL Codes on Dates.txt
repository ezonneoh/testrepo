SELECT DISTINCT(BLLNG_CYC_DT)
FROM DP_VAGG.FACT_BILL_STMT_CHRG
WHERE BLLNG_CYC_DT
BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE('?d1','YYYY-MM-DD'),-3), 'YYYYMM')
AND TO_CHAR(ADD_MONTHS(TO_DATE('?d1','YYYY-MM-DD'),-1), 'YYYYMM');
